{% extends 'core/base.html' %}
{% block content %}
    <section class="content-header">
        <h1>
            Manage Global Settings
            <button class="btn btn-primary" onClick="validateForm()">Save Changes</button>
            <small></small>
        </h1>
        <ol class="breadcrumb">
            <li><a href=""><i class="fa fa-dashboard"></i> Home</a></li>
            <li class='active'>Settings</li>
        </ol>
    </section>
    {% if form.errors %}
        {% for key, value in form.errors.items %}
            <div class="alert alert-danger alert-dismissable">
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                {{ key }}{{ value }}
            </div>
        {% endfor %}
    {% endif %}
    {% if messages %}
        {% for message in messages %}
            <div class="alert {% if message.tags == 'INFO' %}alert-info {% elif message.tags == 'success' %} alert-success {% elif message.tags == 'error' %} alert-danger {% else %} alert-warning {% endif %} alert-dismissable">
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
    <section class="content">
        <form class="form-horizontal" role="form" method="post" action="." id="main">
            {% csrf_token %}
            <input type="hidden" value="{{ user.is_superuser }}" id="super_user"/>
            <input type="hidden" value="0" name="tax"/>
            {% if user.is_superuser %}
                <input type="hidden" value="NO" name="send_pin_prerefill" />
                <div class="row">
                    <div class="col-md-6">
                        <div class="box box-solid box-primary">
                            <div class="box-header">
                                <h3 class="box-title">Deathbycaptcha Account</h3>
                            </div>
                            <div class="box-body">
                                <div class="form-group {% if form.deathbycaptcha_user.errors %}has-error{% endif %}" id="div_deathbycaptcha_user">
                                    <label for="id_deathbycaptcha_user" class="col-sm-4 control-label">Username</label>
                                    <div class="col-sm-7">
                                        <input id="id_deathbycaptcha_user" name="deathbycaptcha_user" type="text"
                                               class="form-control"
                                               value="{{ form.deathbycaptcha_user.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_deathbycaptcha_user">{{ form.deathbycaptcha_user.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.deathbycaptcha_pass.errors %}has-error{% endif %}" id="div_deathbycaptcha_pass">
                                    <label for="id_deathbycaptcha_pass" class="col-sm-4 control-label">Password</label>
                                    <div class="col-sm-7">
                                        <input id="id_deathbycaptcha_pass" name="deathbycaptcha_pass" type="password"
                                               class="form-control"
                                               value="{{ form.deathbycaptcha_pass.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_deathbycaptcha_pass">{{ form.deathbycaptcha_pass.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.deathbycaptcha_count.errors %}has-error{% endif %}" id="div_deathbycaptcha_count">
                                    <label for="id_deathbycaptcha_count" class="col-sm-4 control-label">Used Capthca Notification</label>
                                    <div class="col-sm-6">
                                        <input id="id_deathbycaptcha_count" name="deathbycaptcha_count" type="text"
                                               class="form-control tooltip-activate"
                                               data-toggle="tooltip"
                                               data-placement="bottom"
                                               title="Enter the number after which you will receive an email notification"
                                               value="{{ form.deathbycaptcha_count.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_deathbycaptcha_count">{{ form.deathbycaptcha_count.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.deathbycaptcha_email_balance.errors %}has-error{% endif %}" id="div_deathbycaptcha_email_balance">
                                    <label for="id_deathbycaptcha_email_balance" class="col-sm-4 control-label">
                                        Low Balance Notification
                                    </label>
                                    <div class="col-sm-6">
                                        <input id="id_deathbycaptcha_email_balance" name="deathbycaptcha_email_balance"
                                               type="text" class="form-control tooltip-activate"
                                               data-toggle="tooltip"
                                               data-placement="bottom"
                                               title="Enter the balance in cent below which you will receive an email notification"
                                               value="{{ form.deathbycaptcha_email_balance.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_deathbycaptcha_email_balance">View <a href="http://www.deathbycaptcha.com/user/order">deathbycaptcha</a>prices</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="box box-solid box-primary">
                            <div class="box-header">
                                <h3 class="box-title tooltip-activate"
                                    data-toggle="tooltip"
                                    data-placement="right"
                                    title="Account used to send transaction status emails to customers">
                                    Mandrill Account
                                </h3>
                            </div>
                            <div class="box-body">
                                <div class="form-group {% if form.mandrill_key.errors %}has-error{% endif %}" id="div_mandrill_key">
                                    <label for="id_mandrill_key" class="col-sm-4 control-label">API Key</label>
                                    <div class="col-sm-7">
                                        <input id="id_mandrill_key"
                                               name="mandrill_key"
                                               type="text"
                                               class="form-control"
                                               value="{{ form.mandrill_key.value|default_if_none:'' }}"/>
                                    </div>
                                </div>
                                <div class="form-group {% if form.mandrill_email.errors %}has-error{% endif %}" id="div_mandrill_email">
                                    <label for="id_mandrill_email" class="col-sm-4 control-label">From Email ID</label>
                                    <div class="col-sm-7">
                                        <input id="id_mandrill_email" name="mandrill_email" type="text"
                                               class="form-control"
                                               value="{{ form.mandrill_email.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_mandrill_email">{{ form.mandrill_email.errors }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box box-solid box-primary">
                            <div class="box-header">
                                <h3 class="box-title">Asana</h3>
                            </div>
                            <div class="box-body">
                                <div class="form-group">
                                    <label for="id_use_asana" class="col-sm-4 control-label">Use Asana</label>
                                    <div class="col-sm-6">
                                        <div class="checkbox">
                                            <input type="checkbox" id="id_use_asana" name="use_asana" {% if form.use_asana.value %}checked{% endif %}>
                                        </div>
                                        <span class="help-block" id="help_use_asana">Check this option if you want to use asana</span>
                                    </div>
                                </div>
                                <div id="asana_hide" {% if not form.use_asana.value %}style="display: none;" {% endif %}>
                                    <div class="form-group {% if form.asana_api_key.errors %}has-error{% endif %}" id="div_asana_api_key">
                                        <label for="id_asana_api_key" class="col-sm-4 control-label">API Key</label>
                                        <div class="col-sm-6">
                                            <input id="id_asana_api_key" name="asana_api_key" type="text"
                                                   class="form-control tooltip-activate"
                                                   data-toggle="tooltip"
                                                   data-placement="bottom"
                                                   title="Enter the asana API key. You can get your own API key by visiting the Account Settings dialog and clicking on the Apps tab"
                                                   value="{{ form.asana_api_key.value|default_if_none:'' }}"/>
                                            <span class="help-block" id="help_asana_api_key">{{ form.asana_api_key.errors }}</span>
                                        </div>
                                    </div>
                                    <div class="form-group {% if form.asana_workspace.errors %}has-error{% endif %}" id="div_asana_workspace">
                                        <label for="id_asana_workspace" class="col-sm-4 control-label">Workspace</label>
                                        <div class="col-sm-6">
                                            <input id="id_asana_workspace" name="asana_workspace" type="text"
                                                   class="form-control tooltip-activate"
                                                   data-toggle="tooltip"
                                                   data-placement="bottom"
                                                   title="Enter the asana workspace ID."
                                                   value="{{ form.asana_workspace.value|default_if_none:'' }}"/>
                                            <span class="help-block" id="help_asana_workspace">{{ form.asana_workspace.errors }}</span>
                                        </div>
                                    </div>
                                    <div class="form-group {% if form.asana_project_name.errors %}has-error{% endif %}"
                                         id="div_asana_project_name">
                                        <label for="id_asana_project_name" class="col-sm-4 control-label">Project Name</label>
                                        <div class="col-sm-6">
                                            <input id="id_asana_project_name" name="asana_project_name" type="text"
                                                   class="form-control tooltip-activate"
                                                   data-toggle="tooltip"
                                                   data-placement="bottom"
                                                   title="Enter the asana project name where you want to post task."
                                                   value="{{ form.asana_project_name.value|default_if_none:'' }}"/>
                                            <span class="help-block" id="help_asana_project_name">{{ form.asana_project_name.errors }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% else %}
                <div class="row">
                    <div class="col-md-6">
                        <div class="box box-solid box-primary">
                            <div class="box-header">
                                <h3 class="box-title">Company Settings</h3>
                            </div>
                            <div class="box-body">
                                <div class="form-group {% if form.company_name.errors %}has-error{% endif %}" id="div_company_name">
                                    <label for="id_company_name" class="col-sm-4 control-label">Company Name</label>
                                    <div class="col-sm-6">
                                        <input id="id_company_name" name="company_name" type="text"
                                               class="form-control tooltip-activate"
                                               data-toggle="tooltip"
                                               data-placement="bottom"
                                               title="Enter the company name."
                                               value="{{ form.company_name.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_company_name">{{ form.company_name.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.email_id.errors %}has-error{% endif %}" id="div_email_id">
                                    <label for="id_email_id" class="col-sm-4 control-label">Your Mail ID</label>
                                    <div class="col-sm-6">
                                        <input id="id_email_id" name="email_id" type="email"
                                               class="form-control tooltip-activate"
                                               data-toggle="tooltip"
                                               data-placement="bottom"
                                               title="Enter the email id, to which transaction status is sent."
                                               value="{{ form.email_id.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_email_id">{{ form.email_id.errors }}</span>
                                    </div>
                                </div>
                                 <div class="form-group {% if form.email_sales_agent.errors %}has-error{% endif %}" id="div_email_sales_agent">
                                    <label for="input_email_sales_agent" class="col-sm-4 control-label">Email Sales Agent</label>
                                    <div class="col-sm-6">
                                        <input id="input_email_sales_agent" name="email_sales_agent" type="email"
                                               class="form-control tooltip-activate"
                                               data-toggle="tooltip"
                                               data-placement="bottom"
                                               title="Enter the email sales agent, to which customer status is sent."
                                               value="{{ form.email_sales_agent.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_email_sales_agent">{{ form.email_sales_agent.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="id_block_duplicate_schedule" class="col-sm-4 control-label">Block Duplicate Scheduled Refills</label>
                                    <div class="col-sm-6">
                                        <div class="checkbox">
                                            <input id="id_block_duplicate_schedule"
                                                   name="block_duplicate_schedule"
                                                   type="checkbox"
                                                   class="form-control"
                                                   value="2"
                                                   {% if form.block_duplicate_schedule.value %}checked{% endif %}>
                                        </div>
                                        <span class="help-block" id="help_block_duplicate_schedule"></span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="id_block_duplicate_phone_number" class="col-sm-4 control-label">Block Duplicate Phone Numbers</label>
                                    <div class="col-sm-6">
                                        <div class="checkbox">
                                            <input id="id_block_duplicate_phone_number"
                                                   name="block_duplicate_phone_number"
                                                   type="checkbox"
                                                   class="form-control"
                                                   value="2"
                                                   {% if form.block_duplicate_phone_number.value %}checked{% endif %}>
                                        </div>
                                        <span class="help-block" id="help_block_duplicate_phone_number"></span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="id_email_success" class="col-sm-4 control-label">Email On Success</label>
                                    <div class="col-sm-6">
                                        <div class="checkbox">
                                            <input id="id_email_success"
                                                   name="email_success"
                                                   type="checkbox"
                                                   class="form-control"
                                                   value="2"
                                                   {% if form.email_success.value %}checked{% endif %}>
                                        </div>
                                        <span class="help-block" id="help_email_success">Check this option to get status mails even for successful transactions.</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="id_precharge_failed_email" class="col-sm-4 control-label">Email if Precharge Failed</label>
                                    <div class="col-sm-6">
                                        <div class="checkbox">
                                            <input id="id_precharge_failed_email"
                                                   name="precharge_failed_email"
                                                   type="checkbox"
                                                   class="form-control"
                                                   value="2"
                                                   {% if form.precharge_failed_email.value %}checked{% endif %}>
                                        </div>
                                        <span class="help-block" id="help_precharge_failed_email">Check this option to get mails even for precharge was failed.</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="id_insufficient_funds_notification" class="col-sm-4 control-label">Insufficient Funds Notification</label>
                                    <div class="col-sm-6">
                                        <div class="checkbox">
                                            <input id="id_insufficient_funds_notification"
                                                   name="insufficient_funds_notification"
                                                   type="checkbox"
                                                   class="form-control"
                                                   {% if form.insufficient_funds_notification.value %}checked{% endif %}>
                                        </div>
                                        <span class="help-block" id="help_insufficient_funds_notification">Check this option to get mails when cash prepayment customers have insufficient funds</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="id_pin_error" class="col-sm-4 control-label">Email On Pin Errors</label>
                                    <div class="col-sm-6">
                                        <div class="checkbox">
                                            <input
                                                    id="id_pin_error"
                                                    name="pin_error"
                                                    type="checkbox"
                                                    class="form-control"
                                                    value="2"
                                                    {% if form.pin_error.value %}checked{% endif %}>
                                        </div>
                                        <span class="help-block" id="help_pin_error">Check this option to get emails for error that pin is used ( this email will be send even the transaction is not complete and still in progress)</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="id_deposit_amount_notification" class="col-sm-4 control-label">Deposit Amount Notification</label>
                                    <div class="col-sm-6">
                                        <div class="checkbox">
                                            <input
                                                    id="id_deposit_amount_notification"
                                                    name="deposit_amount_notification"
                                                    type="checkbox"
                                                    class="form-control"
                                                    value="2"
                                                    {% if form.deposit_amount_notification.value %}checked{% endif %}>
                                        </div>
                                        <span class="help-block" id="help_deposit_amount_error">Check this option to get email about selling price amount for week.</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.short_retry_limit.errors %}has-error{% endif %}" id="div_short_retry_limit">
                                    <label for="id_short_retry_limit" class="col-sm-4 control-label">Short Retry Limit</label>
                                    <div class="col-sm-6	">
                                        <input id="id_short_retry_limit" name="short_retry_limit" type="number"
                                               class="form-control tooltip-activate"
                                               data-toggle="tooltip"
                                               data-placement="bottom"
                                               title="Set the Maximum number of short retries for a transaction"
                                               value="{{ form.short_retry_limit.value|default_if_none:'3' }}"/>
                                        <span class="help-block" id="help_short_retry_limit">{{ form.short_retry_limit.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.short_retry_interval.errors %}has-error{% endif %}" id="div_short_retry_interval">
                                    <label for="id_short_retry_limit" class="col-sm-4 control-label">Short Retry Interval</label>
                                    <div class="col-sm-6">
                                        <input
                                                id="id_short_retry_interval"
                                                name="short_retry_interval"
                                                type="number"
                                                class="form-control tooltip-activate"
                                                data-toggle="tooltip"
                                                data-placement="bottom"
                                                title="Set the time(in minutes) to wait between short retries"
                                                value="{{ form.short_retry_interval.value|default_if_none:'5' }}"/>
                                        <span class="help-block" id="help_short_retry_interval">{{ form.short_retry_interval.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.long_retry_limit.errors %}has-error{% endif %}" id="div_long_retry_limit">
                                    <label for="id_long_retry_limit" class="col-sm-4 control-label">Long Retry Limit</label>
                                    <div class="col-sm-6">
                                        <input id="id_long_retry_limit" name="long_retry_limit" type="number"
                                               class="form-control tooltip-activate"
                                               data-toggle="tooltip"
                                               data-placement="bottom"
                                               title="Set the Maximum number of long retries for a transaction"
                                               value="{{ form.long_retry_limit.value|default_if_none:'3' }}"/>
                                        <span class="help-block" id="help_long_retry_limit">{{ form.long_retry_limit.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.long_retry_interval.errors %}has-error{% endif %}" id="div_long_retry_interval">
                                    <label for="id_long_retry_limit" class="col-sm-4 control-label">Long Retry Interval</label>
                                    <div class="col-sm-6">
                                        <input
                                                id="id_long_retry_interval"
                                                name="long_retry_interval"
                                                type="number"
                                                class="form-control tooltip-activate"
                                                data-toggle="tooltip"
                                                data-placement="auto bottom"
                                                title="Set the time(in minutes) to wait between long retries"
                                                value="{{ form.long_retry_interval.value|default_if_none:'120' }}"/>
                                        <span class="help-block" id="help_long_retry_interval">{{ form.long_retry_interval.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="id_precharge_failed_email" class="col-sm-4 control-label">Send pin in intermediate step</label>
                                    <div class="col-sm-6">
                                        <div class="checkbox">
                                            <input name="able_change_send_pin_prerefill"
                                                   type="checkbox"
                                                   class="form-control"
                                                   {% if form.able_change_send_pin_prerefill.value == True %}checked{% endif %}
                                                    />
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="id_precharge_failed_email" class="col-sm-4 control-label">Intermediate step notification send</label>
                                    <div class="col-sm-6">
                                        <span class="input-group">
                                            <select name="send_pin_prerefill"
                                                    class="form-control">
                                                {% for value, text in form.send_pin_prerefill.field.choices %}
                                                <option value="{{ value }}" {% if value == form.send_pin_prerefill.value %} selected="selected"{% endif %}>{{ text }}</option>
                                                {% endfor %}
                                            </select>
                                            <span class="input-group-btn">
                                                <button href="{% url 'ajax_apply_send_pin_prerefill' %}"
                                                        id="send_pin_prerefill-apply"
                                                        class="btn btn-primary"
                                                        type="button"
                                                        disabled
                                                        >Apply</button>
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="set_default_notification" class="col-sm-4 control-label">Default Notification method</label>
                                    <div class="col-sm-6">
                                        <span class="input-group-btn">
                                                <button href=" {%url 'ajax_set_default_notification'%} "
                                                        id="set_default_notification"
                                                        class="btn btn-primary"
                                                        type="button"
                                                        >Set by Default</button>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box box-solid box-primary">
                            <div class="box-header">
                                <h3 class="box-title tooltip-activate"
                                    data-toggle="tooltip"
                                    data-placement="right"
                                    title="Sales Tax">
                                    Sales Tax
                                </h3>
                            </div>
                            <div class="box-body">
                                <div class="form-group {% if form.tax.errors %}has-error{% endif %}" id="div_tax">
                                    <label for="id_tax" class="col-sm-4 control-label">Tax</label>
                                    <div class="col-sm-6">
                                        <input id="id_tax" name="tax" type="text"
                                               class="form-control tooltip-activate"
                                               data-toggle="tooltip"
                                               data-placement="bottom"
                                               title="Enter sales tax in percent."
                                               value="{{ form.tax.value }}"/>
                                        <span class="help-block" id="help_tax">{{ form.tax.errors }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box box-solid box-primary">
                            <div class="box-header">
                                <h3 class="box-title">Dollar Phone Account</h3>
                            </div>
                            <div class="box-body">
                                <div class="form-group {% if form.dollar_type.errors %}has-error{% endif %}" id="div_dollar_type">
                                    <label for="id_dollar_type" class="col-sm-4 control-label">Account Type</label>
                                    <div class="col-sm-6">
                                        <select class="form-control" id="id_dollar_type" name="dollar_type">
                                            {% for value, text in form.dollar_type.field.choices %}
                                                <option value="{{ value }}" {% if value == form.dollar_type.value %} selected="selected"{% endif %}>{{ text }}</option>
                                            {% endfor %}
                                        </select>
                                        <span class="help-block" id="help_dollar_type">{{ form.dollar_type.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.dollar_user.errors %}has-error{% endif %}" id="div_dollar_user">
                                    <label for="id_dollar_user" class="col-sm-4 control-label">Username</label>
                                    <div class="col-sm-7">
                                        <input id="id_dollar_user"
                                               name="dollar_user"
                                               type="text"
                                               class="form-control"
                                               value="{{ form.dollar_user.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_dollar_user">{{ form.dollar_user.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.dollar_pass.errors %}has-error{% endif %}" id="div_dollar_pass">
                                    <label for="id_dollar_pass" class="col-sm-4 control-label">Password</label>
                                    <div class="col-sm-7">
                                        <input id="id_dollar_pass"
                                               name="dollar_pass"
                                               type="password"
                                               class="form-control"
                                               value="{{ form.dollar_pass.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_dollar_pass">{{ form.dollar_pass.errors }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box box-solid box-primary">
                            <div class="box-header">
                                <h3 class="box-title">Credit Card Charge</h3>
                            </div>
                            <div class="box-body">
                                <div class="form-group {% if form.cccharge_type.errors %}has-error{% endif %}" id="cccharge_type">
                                    <label for="id_cccharge_type" class="col-sm-4 control-label">Type</label>
                                    <div class="col-sm-7">
                                        <select class="form-control" id="id_cccharge_type" name="cccharge_type">
                                            {% for value, text in form.cccharge_type.field.choices %}
                                                <option value="{{ value }}" {% if value == form.cccharge_type.value %} selected="selected"{% endif %} >{{ text }}</option>
                                            {% endfor %}
                                        </select>
                                        <span class="help-block" id="help_cccharge_type">{{ form.cccharge_type.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.authorize_precharge_days.errors %}has-error{% endif %}">
                                    <label for="id_authorize_precharge_days" class="col-sm-4 control-label">Pre CC charge days</label>
                                    <div class="col-sm-6">
                                        <input id="id_authorize_precharge_days" name="authorize_precharge_days"
                                               type="number"
                                               class="form-control tooltip-activate"
                                               data-toggle="tooltip"
                                               data-placement="bottom"
                                               title="Set the no of days prior to a scheduled refill for pre cc charge, set to 0 to disable this feature"
                                               value="{{ form.authorize_precharge_days.value|default_if_none:'0' }}"/>
                                        <span class="help-block">{{ form.authorize_precharge_days.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="id_pin_error" class="col-sm-4 control-label">Getting Notifications about Unused Charges</label>
                                    <div class="col-sm-6">
                                        <div class="checkbox">
                                            <input id="id_unused_charge_notification"
                                                   name="unused_charge_notification"
                                                   type="checkbox"
                                                   class="form-control"
                                                   value="2"
                                                   {% if form.unused_charge_notification.value %}checked{% endif %}>
                                        </div>
                                        <span class="help-block" id="help_unused_charge_notification">Check this option to sending autorefund unused charges and sending in email.</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.precharge_notification_type.errors %}has-error{% endif %}" id="div_precharge_notification_type">
                                    <label for="id_precharge_notification_type" class="col-sm-4 control-label">Send Precharge Notifications</label>
                                    <div class="col-sm-6">
                                        <select class="form-control" id="id_precharge_notification_type" name="precharge_notification_type">
                                            {% for value, text in form.precharge_notification_type.field.choices %}
                                                <option value="{{ value }}" {% if value == form.precharge_notification_type.value %} selected="selected"{% endif %}>{{ text }}</option>
                                            {% endfor %}
                                        </select>
                                        <span class="help-block">Choose getaway to sending notifications to customer for precharge</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box box-solid box-primary">
                            <div class="box-header">
                                <h3 class="box-title">Authorize.net Account</h3>
                            </div>
                            <div class="box-body">
                                <div class="form-group {% if form.authorize_api_login_id.errors %}has-error{% endif %}" id="authorize_api_login_id">
                                    <label for="id_authorize_api_login_id" class="col-sm-4 control-label">API login id</label>
                                    <div class="col-sm-7">
                                        <input id="id_authorize_api_login_id" name="authorize_api_login_id" type="text"
                                               class="form-control"
                                               value="{{ form.authorize_api_login_id.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_authorize_api_login_id">{{ form.authorize_api_login_id.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.authorize_transaction_key.errors %}has-error{% endif %}" id="authorize_transaction_key">
                                    <label for="id_authorize_transaction_key" class="col-sm-4 control-label">API transaction key</label>
                                    <div class="col-sm-7">
                                        <input id="id_authorize_transaction_key" name="authorize_transaction_key"
                                               type="text"
                                               class="form-control"
                                               value="{{ form.authorize_transaction_key.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_authorize_transaction_key">{{ form.authorize_transaction_key.errors }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box box-solid box-primary">
                            <div class="box-header">
                                <h3 class="box-title">USAePay Account</h3>
                            </div>
                            <div class="box-body">
                                <div class="form-group {% if form.usaepay_username.errors %}has-error{% endif %}" id="usaepay_username">
                                    <label for="id_usaepay_username" class="col-sm-4 control-label">USAePay Username</label>
                                    <div class="col-sm-7">
                                        <input id="id_usaepay_username"
                                               name="usaepay_username"
                                               type="text"
                                               class="form-control"
                                               value="{{ form.usaepay_username.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_usaepay_username">{{ form.usaepay_username.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.usaepay_password.errors %}has-error{% endif %}" id="usaepay_password">
                                    <label for="id_usaepay_password" class="col-sm-4 control-label">USAePay Password</label>
                                    <div class="col-sm-7">
                                        <input id="id_usaepay_password" name="usaepay_password" type="text"
                                               class="form-control"
                                               value="{{ form.usaepay_password.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_usaepay_password">{{ form.usaepay_password.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.usaepay_source_key.errors %}has-error{% endif %}" id="usaepay_source_key">
                                    <label for="id_usaepay_source_key" class="col-sm-4 control-label">Source Key</label>
                                    <div class="col-sm-7">
                                        <input id="id_usaepay_source_key"
                                               name="usaepay_source_key"
                                               type="text"
                                               class="form-control"
                                               value="{{ form.usaepay_source_key.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_usaepay_source_key">{{ form.usaepay_source_key.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.usaepay_pin.errors %}has-error{% endif %}" id="usaepay_pin">
                                    <label for="id_usaepay_pin" class="col-sm-4 control-label">Pin</label>
                                    <div class="col-sm-7">
                                        <input id="id_usaepay_pin"
                                               name="usaepay_pin"
                                               type="text"
                                               class="form-control"
                                               value="{{ form.usaepay_pin.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_usaepay_pin">{{ form.usaepay_pin.errors }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box box-solid box-primary">
                            <div class="box-header">
                                <h3 class="box-title tooltip-activate"
                                    data-toggle="tooltip"
                                    data-placement="right"
                                    title="Setting for page plus recharge">
                                    Page Plus Refill
                                </h3>
                            </div>
                            <div class="box-body">
                                <div class="form-group {% if form.pageplus_refillmethod.errors %}has-error{% endif %}" id="div_pageplus_refillmethod">
                                    <label for="id_dollar_type" class="col-sm-4 control-label">Refill Method</label>
                                    <div class="col-sm-6">
                                        <select class="form-control" id="id_pageplus_refillmethod" name="pageplus_refillmethod">
                                            {% for value, text in form.pageplus_refillmethod.field.choices %}
                                                <option value="{{ value }}" {% if value == form.pageplus_refillmethod.value %} selected="selected"{% endif %}>{{ text }}</option>
                                            {% endfor %}
                                        </select>
                                        <span class="help-block" id="help_pageplus_refillmethod">{{ form.pageplus_refillmethod.errors }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="box box-solid box-primary">
                            <div class="box-header">
                                <h3 class="box-title">Twilio Account</h3>
                            </div>
                            <div class="box-body">
                                <div class="form-group {% if form.dollar_user.errors %}has-error{% endif %}" id="div_twilio_number">
                                    <label for="id_twilio_number" class="col-sm-4 control-label">Phone Number</label>
                                    <div class="col-sm-5">
                                        <div class="input-group ">
                                            <div class="input-group-addon">
                                                <i class="fa fa-phone"></i>
                                            </div>
                                            <input type="text"
                                                   class="form-control"
                                                   data-inputmask='"mask": "(999) 999-9999"'
                                                   data-mask id="id_twilio_number"
                                                   name="twilio_number"
                                                   value="{{ form.twilio_number.value|default_if_none:'' }}"/>
                                        </div>
                                        <span class="help-block" id="help_twilio_number">{{ form.twilio_number.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.twilio_sid.errors %}has-error{% endif %}" id="div_twilio_sid">
                                    <label for="id_twilio_sid" class="col-sm-4 control-label">Account SID</label>
                                    <div class="col-sm-7">
                                        <input id="id_twilio_sid"
                                               name="twilio_sid"
                                               type="text"
                                               class="form-control"
                                               value="{{ form.twilio_sid.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_twilio_sid">{{ form.twilio_sid.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.twilio_auth_token.errors %}has-error{% endif %}" id="div_twilio_auth_token">
                                    <label for="id_twilio_auth_token" class="col-sm-4 control-label">AUTH Token</label>
                                    <div class="col-sm-7">
                                        <input id="id_twilio_auth_token"
                                               name="twilio_auth_token"
                                               type="text"
                                               class="form-control"
                                               value="{{ form.twilio_auth_token.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_twilio_auth_token">{{ form.twilio_auth_token.errors }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box box-solid box-primary">
                            <div class="box-header">
                                <h3 class="box-title tooltip-activate"
                                    data-toggle="tooltip"
                                    data-placement="right"
                                    title="Account used to send transaction status emails to customers">
                                    Mandrill Account
                                </h3>
                            </div>
                            <div class="box-body">
                                <div class="form-group {% if form.mandrill_key.errors %}has-error{% endif %}" id="div_mandrill_key">
                                    <label for="id_mandrill_key" class="col-sm-4 control-label">API Key</label>
                                    <div class="col-sm-7">
                                        <input id="id_mandrill_key"
                                               name="mandrill_key"
                                               type="text"
                                               class="form-control"
                                               value="{{ form.mandrill_key.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_mandrill_key">{{ form.mandrill_key.errors }}</span>
                                    </div>
                                </div>
                                <div class="form-group {% if form.mandrill_email.errors %}has-error{% endif %} " id="div_mandrill_email">
                                    <label for="id_mandrill_email" class="col-sm-4 control-label">From Email ID</label>
                                    <div class="col-sm-7">
                                        <input id="id_mandrill_email"
                                               name="mandrill_email"
                                               type="text"
                                               class="form-control"
                                               value="{{ form.mandrill_email.value|default_if_none:'' }}"/>
                                        <span class="help-block" id="help_mandrill_email">{{ form.mandrill_email.errors }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box box-solid box-primary">
                            <div class="box-header">
                                <h3 class="box-title">Sellercloud</h3>
                            </div>
                            <div class="box-body">
                                <div class="form-group">
                                    <label for="id_use_sellercloud" class="col-sm-4 control-label">Use SellerCloud</label>
                                    <div class="col-sm-6">
                                        <div class="checkbox">
                                            <input type="checkbox" id="id_use_sellercloud" name="use_sellercloud" {% if form.use_sellercloud.value %}checked{% endif %}>
                                        </div>
                                        <span class="help-block" id="help_use_sellercloud">Check this option if you want to use sellercloud</span>
                                    </div>
                                </div>
                                <div id="sellercloud_hide" {% if not form.use_sellercloud.value %} style="display: none;" {% endif %}>
                                    <div class="form-group {% if form.sc_email.errors %}has-error{% endif %}" id="sc_email">
                                        <label for="id_sc_email" class="col-sm-4 control-label"> SellerCloud User Email</label>
                                        <div class="col-sm-7">
                                            <input id="id_sc_email"
                                                   name="sc_email"
                                                   type="text"
                                                   class="form-control"
                                                   value="{{ form.sc_email.value|default_if_none:'' }}"/>
                                            <span class="help-block" id="help_sc_email">{{ form.sc_email.errors }}</span>
                                        </div>
                                    </div>
                                    <div class="form-group {% if form.sc_password.errors %}has-error{% endif %}" id="sc_password">
                                        <label for="id_sc_password" class="col-sm-4 control-label"> SellerCloud User Password</label>
                                        <div class="col-sm-7">
                                            <input id="id_sc_password"
                                                   name="sc_password"
                                                   type="text"
                                                   class="form-control"
                                                   value="{{ form.sc_password.value|default_if_none:'' }}"/>
                                            <span class="help-block" id="help_sc_password">{{ form.sc_password.errors }}</span>
                                        </div>
                                    </div>
                                    <div class="form-group {% if form.sc_company_id.errors %}has-error{% endif %}" id="sc_company_id">
                                        <label for="id_sc_company_id" class="col-sm-4 control-label"> SellerCloud Company D</label>
                                        <div class="col-sm-7">
                                            <input id="id_sc_company_id" name="sc_company_id" type="text"
                                                   class="form-control"
                                                   value="{{ form.sc_company_id.value|default_if_none:'' }}"/>
                                            <span class="help-block" id="help_sc_company_id">{{ form.sc_company_id.errors }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box box-solid box-primary">
                            <div class="box-header">
                                <h3 class="box-title">Asana</h3>
                            </div>
                            <div class="box-body">
                                <div class="form-group">
                                    <label for="id_use_asana" class="col-sm-4 control-label">Use Asana</label>
                                    <div class="col-sm-6">
                                        <div class="checkbox">
                                            <input type="checkbox" id="id_use_asana" name="use_asana" {% if form.use_asana.value %}checked{% endif %}>
                                        </div>
                                        <span class="help-block" id="help_use_asana">Check this option if you want to use asana</span>
                                    </div>
                                </div>
                                <div id="asana_hide" {% if not form.use_asana.value %}style="display: none;" {% endif %}>
                                    <div class="form-group {% if form.asana_api_key.errors %}has-error{% endif %}" id="div_asana_api_key">
                                        <label for="id_asana_api_key" class="col-sm-4 control-label">API Key</label>
                                        <div class="col-sm-6">
                                            <input id="id_asana_api_key" name="asana_api_key" type="text"
                                                   class="form-control tooltip-activate"
                                                   data-toggle="tooltip"
                                                   data-placement="bottom"
                                                   title="Enter the asana API key. You can get your own API key by visiting the Account Settings dialog and clicking on the Apps tab"
                                                   value="{{ form.asana_api_key.value|default_if_none:'' }}"/>
                                            <span class="help-block" id="help_asana_api_key">{{ form.asana_api_key.errors }}</span>
                                        </div>
                                    </div>
                                    <div class="form-group {% if form.asana_workspace.errors %}has-error{% endif %}" id="div_asana_workspace">
                                        <label for="id_asana_workspace" class="col-sm-4 control-label">Workspace</label>
                                        <div class="col-sm-6">
                                            <input id="id_asana_workspace" name="asana_workspace" type="text"
                                                   class="form-control tooltip-activate"
                                                   data-toggle="tooltip"
                                                   data-placement="bottom"
                                                   title="Enter the asana workspace ID."
                                                   value="{{ form.asana_workspace.value|default_if_none:'' }}"/>
                                            <span class="help-block" id="help_asana_workspace">{{ form.asana_workspace.errors }}</span>
                                        </div>
                                    </div>
                                    <div class="form-group {% if form.asana_project_name.errors %}has-error{% endif %}"
                                         id="div_asana_project_name">
                                        <label for="id_asana_project_name" class="col-sm-4 control-label">Project Name</label>
                                        <div class="col-sm-6">
                                            <input id="id_asana_project_name" name="asana_project_name" type="text"
                                                   class="form-control tooltip-activate"
                                                   data-toggle="tooltip"
                                                   data-placement="bottom"
                                                   title="Enter the asana project name where you want to post task."
                                                   value="{{ form.asana_project_name.value|default_if_none:'' }}"/>
                                            <span class="help-block" id="help_asana_project_name">{{ form.asana_project_name.errors }}</span>
                                        </div>
                                    </div>
                                    <div class="form-group {% if form.asana_user.errors %}has-error{% endif %}"
                                         id="div_asana_user">
                                        <label for="id_asana_user" class="col-sm-4 control-label">User ID</label>
                                        <div class="col-sm-6">
                                            <input id="id_asana_user" name="asana_user" type="text"
                                                   class="form-control tooltip-activate"
                                                   data-toggle="tooltip"
                                                   data-placement="bottom"
                                                   title="Enter the asana user ID."
                                                   value="{{ form.asana_user.value|default_if_none:'' }}"/>
                                            <span class="help-block" id="help_asana_user">{{ form.asana_user.errors }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}
        </form>
    </section>
{% endblock %}
{% block body_js %}
    <script src="{{ STATIC_URL }}js/input-mask/jquery.inputmask.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}js/input-mask/jquery.inputmask.extensions.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}js/userprofile.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('.tooltip-activate').tooltip();
            $('#__settings ul').css('display', 'block');
            $('#__settings').addClass("active");
            $('#__profile').addClass("active");
            //$("#id_twilio_number").inputmask();
            $('#id_use_sellercloud').on('ifChanged', function (event) {
                $('#sellercloud_hide').toggle();
            });
            $('#id_use_asana').on('ifChanged', function (event) {
                $('#asana_hide').toggle();
            });
        });
        function validateForm() {
            var super_user = $('#super_user').val();
            if (super_user != "True") {
                var fields = [
                    'email_id',
                    'short_retry_limit',
                    'short_retry_interval',
                    'long_retry_limit',
                    'long_retry_interval',
                ];
                // TODO check why not save
//                for (var i = 0; i < fields.length; i++) {
//                    if (!document.forms[0][fields[i]].value) {
//                        $('#help_' + fields[i]).text('This field is mandatory');
//                        $('#div_' + fields[i]).addClass("has-error");
//                        $('#id_' + fields[i]).focus();
//                        return false;
//                    }
//                }
//                if (document.forms[0]['dollar_user'].value && document.forms[0]['dollar_pass'].value && !document.forms[0]['dollar_type'].value) {
//                    $('#help_dollar_type').text('Account type needs to be specified');
//                    $('#div_dollar_type').addClass("has-error");
//                    $('#id_dollar_type').focus();
//                    return false;
//                }
//                if (document.forms[0]['dollar_type'].value && !document.forms[0]['dollar_pass'].value) {
//                    $('#help_dollar_pass').text('Password is mandatory needs to be specified');
//                    $('#div_dollar_pass').addClass("has-error");
//                    $('#id_dollar_pass').focus();
//                    return false;
//                }
//                if (document.forms[0]['dollar_type'].value && !document.forms[0]['dollar_user'].value) {
//                    $('#help_dollar_user').text('User name is mandatory needs to be specified');
//                    $('#div_dollar_user').addClass("has-error");
//                    $('#id_dollar_user').focus();
//                    return false;
//                }
            }
            $("#main").submit();
        }
    </script>
{% endblock %}